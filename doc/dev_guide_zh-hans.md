<!-- TOC -->
* [前言](#前言)
* [什么是服务器事件?](#什么是服务器事件)
  * [基事件](#基事件)
    * [属性](#属性)
  * [事件的创建](#事件的创建)
    * [存储位置](#存储位置)
<!-- TOC -->

# 前言

在1.x版本的服务器中,我们已经意识到直接读写数据库会带来一些不可预见的问题,同时也发现了由于不完善的数据库模块所导致的逻辑混乱.因此,在假期期间,我们对服务器进行了重新编写,并优化了数据库模块,以期提供更好的开发体验.

这次重写的主要目的是为了优化开发流程,减少部分繁琐的重复操作,提高开发效率.但是,考虑到插件系统的开发并不是必要的,而且会增加日常开发的难度,我们决定将其删除.

# 什么是服务器事件?

"服务器事件"(在本段中简称为 "事件")是服务器的基础,它是 API 的入口,也是某些方法的具体实现.

## 基事件

基事件是所有事件的基类,主要作用是提供部分数据(如`user_id`),并检查请求参数的完整性.

### 属性

| 属性名     | 名称      | 描述                   |
|---------|---------|----------------------|
| user_id | 用户id    | 用户的id,**必须要登录后才能获取** |
| server  | 服务器     | 实例化的服务器类             |
| e_mgr   | 事件管理器   | 用于运行事件               |
| path    | 路径      | 用户请求时的路径             |
| req     | request | >Flask 框架默认使用的请求对象   |

## 事件的创建

### 存储位置

`请求事件`必须在`event/events`目录下创建,并且其路径相对于`events`目录即为`API`的访问路径.

相对应的,其他`事件`可以在任意位置创建,但请务必将它们创建在`event`目录的任意位置.

### 创建流程
1. 创建事件文件,请使用`下划线命名法`(`underscore_case`).
2. 在刚才创建的文件中创建类,类名应与刚刚文件名相同,请使用`大写驼峰命名法`(`PascalCase`).
3. 设置验证模式,默认为启用验证.
4. 定义入口函数.

具体实现为:
```python
from event.base_event import BaseEvent


class Login(BaseEvent):
    auth = False

    def _run(self, you_arg_1,you_arg_2='default value'):
        ...
```
